#if UNITY_EDITOR
using System;
using UnityEngine;
using System.Collections.Generic;

namespace Mona
{
    // Quality Checks that run both in editor and in private-build
    public static partial class QualityAssurance
    {
        // Is a list of error codes generated by the space.
        public static Dictionary<string, List<int>> SpaceErrors;
        public static EditorHierarchyDrawer HierarchyDrawer;

        // Run QA check
        public static Dictionary<string, List<int>> GetSpaceErrors()
        {
            // Add a test error
            SpaceErrors = new Dictionary<string, List<int>>();

            TestSceneExistence("Space", MonaErrorCodes.MISSING_SPACE_SCENE);
            TestSceneExistence("Portals", MonaErrorCodes.MISSING_PORTAL_SCENE);

            TestSceneLayer("Space", "Space", MonaErrorCodes.MISSING_SPACE_LAYER, MonaErrorCodes.MULTIPLE_SPACE_ROOTS);
            TestSceneLayer("Portals", "PortalLayer", MonaErrorCodes.MISSING_PORTAL_LAYER, MonaErrorCodes.MULTIPLE_PORTAL_ROOTS);

            TestObjectPlacements("Portal", "PortalLayer", MonaErrorCodes.BAD_PORTAL_PLACEMENT);

            TestNameUniqueness("Portal", MonaErrorCodes.DUPLICATE_PORTAL_NAME);

            TestLayerContents("PortalLayer", "Portal", MonaErrorCodes.BAD_PORTAL_LAYER_CONTENTS);
            
            TestObjectColliders<BoxCollider>("Portal", MonaErrorCodes.BAD_PORTAL_COLLIDER);

            if (HierarchyDrawer != null)
            {
                HierarchyDrawer.Unregister();
            }
            else
            {
                HierarchyDrawer = new EditorHierarchyDrawer();
            }

            HierarchyDrawer.Register(SpaceErrors);

            return SpaceErrors;
        }
    }
}
#endif